now train a audio spectrogram transformer model
balanced sampler is not used
---------------the train dataloader---------------
now using following mask: 24 freq, 96 time
now using mix-up with rate 0.000000
now process custom
use dataset mean -5.519 and std 4.572 to normalize the input.
number of classes is 21
---------------the evaluation dataloader---------------
now using following mask: 0 freq, 0 time
now using mix-up with rate 0.000000
now process custom
use dataset mean -5.519 and std 4.572 to normalize the input.
number of classes is 21
---------------AST Model Summary---------------
ImageNet pretraining: True, AudioSet pretraining: True
frequncey stride=10, time stride=10
number of patches=600
Creating experiment directory: ./exp/train-custom-f10-t10-impTrue-aspTrue-b48-lr1e-5-6-istangull_ncd_sm/fold1
Now starting training for 6 epochs
2022-04-18 17:54:00.270205
running on cuda
state dict to model completed => pretrained weights loaded
Total parameter number is : 87.273 million
Total trainable parameter number is : 87.273 million
scheduler for custom dataset is used
now training with custom, main metrics: mAP, loss function: BCEWithLogitsLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f9ef404fb20>
current #steps=0, #epochs=1
start training...
---------------
2022-04-18 17:54:00.693165
current #epochs=1, #steps=0
Traceback (most recent call last):
  File "/scratch/users/fsofian19/COMP491_model/models/ast_custom/egs/custom/../../src/run.py", line 150, in <module>
    train(audio_model, train_loader, val_loader, args)
  File "/scratch/users/fsofian19/COMP491_model/models/ast_custom/src/traintest.py", line 129, in train
    for i, (audio_input, labels, label_weights ) in enumerate(train_loader):
  File "/kuacc/users/fsofian19/.conda/envs/ast_env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 517, in __next__
    data = self._next_data()
  File "/kuacc/users/fsofian19/.conda/envs/ast_env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1199, in _next_data
    return self._process_data(data)
  File "/kuacc/users/fsofian19/.conda/envs/ast_env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1225, in _process_data
    data.reraise()
  File "/kuacc/users/fsofian19/.conda/envs/ast_env/lib/python3.9/site-packages/torch/_utils.py", line 429, in reraise
    raise self.exc_type(msg)
KeyError: Caught KeyError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/kuacc/users/fsofian19/.conda/envs/ast_env/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 202, in _worker_loop
    data = fetcher.fetch(index)
  File "/kuacc/users/fsofian19/.conda/envs/ast_env/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 44, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/kuacc/users/fsofian19/.conda/envs/ast_env/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 44, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/scratch/users/fsofian19/COMP491_model/models/ast_custom/src/dataloader_custom.py", line 313, in __getitem__
    sec_labels = datum['sec_labels']
KeyError: 'sec_labels'